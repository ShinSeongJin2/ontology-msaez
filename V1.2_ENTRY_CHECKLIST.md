# v1.2 ì§„ì… ê¸°ì¤€ ì²´í¬ë¦¬ìŠ¤íŠ¸

## ğŸ“‹ v1.2 ì§„ì… ê°€ëŠ¥ ì—¬ë¶€ íŒë‹¨ ê¸°ì¤€

ì•„ë˜ 3ê°€ì§€ ê¸°ì¤€ì´ ëª¨ë‘ ì¶©ì¡±ë˜ì–´ì•¼ v1.2(Phase A/B í†µí•© ì‹¤í–‰)ë¡œ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## âœ… ê¸°ì¤€ 1: ì…ë ¥ ê³„ì•½ ê³ ì •

**ì˜ë¯¸**: Context Builderê°€ í•­ìƒ ë™ì¼í•œ ì…ë ¥ ê³„ì•½(JSON êµ¬ì¡°)ì„ ìƒì„±í•œë‹¤.

**ê²€ì¦ ë°©ë²•**:
```bash
# Neo4jì— í…ŒìŠ¤íŠ¸ ë°ì´í„°ê°€ ìˆëŠ” ìƒíƒœì—ì„œ
python3 python/example/regeneration_context_builder.py \
  --story US_001 \
  --dirty AGG_ORDER F_ORDER_AMOUNT \
  --project PRJ_001
```

**í™•ì¸ ì‚¬í•­**:
- [ ] ì¶œë ¥ì´ í•­ìƒ ë™ì¼í•œ êµ¬ì¡°ë¥¼ ê°€ì§
- [ ] `root_story_id`, `dirty`, `requirements`, `context` í•„ë“œ ì¡´ì¬
- [ ] `requirements.story`, `requirements.criteria` êµ¬ì¡° ì¼ê´€ì„±
- [ ] `context.bounded_context_hint`, `context.existing_aggregate_snapshot` êµ¬ì¡° ì¼ê´€ì„±

**í˜„ì¬ ìƒíƒœ**: âœ… `regeneration_context_builder.py`ì—ì„œ `build_phase_a_aggregate_context`ê°€ ê³„ì•½ êµ¬ì¡°ë¥¼ ë°˜í™˜í•¨

---

## âœ… ê¸°ì¤€ 2: Neo4j ì˜ì¡´ì„±ë§Œ ìˆìŒ

**ì˜ë¯¸**: Firebase payload ì—†ì´, ì™¸ë¶€ JSON ì—†ì´, Neo4jë§Œ ìˆìœ¼ë©´ Contextë¥¼ êµ¬ì„± ê°€ëŠ¥.

**ê²€ì¦ ë°©ë²•**:
- [ ] `RegenerationContextBuilder`ê°€ `GraphDatabase.driver`ë§Œ ì‚¬ìš©
- [ ] Firebase import ì—†ìŒ
- [ ] ì™¸ë¶€ JSON íŒŒì¼ ì˜ì¡´ì„± ì—†ìŒ
- [ ] ëª¨ë“  ë°ì´í„°ê°€ Neo4j ì¿¼ë¦¬ë¡œ ì¡°íšŒë¨

**í˜„ì¬ ìƒíƒœ**: âœ… `regeneration_context_builder.py`ëŠ” Neo4jë§Œ ì‚¬ìš©

**í™•ì¸ëœ ì¿¼ë¦¬ë“¤**:
- `_get_story`: UserStory ì¡°íšŒ
- `_get_criteria`: AcceptanceCriterion ì¡°íšŒ (HAS_CRITERION ê´€ê³„)
- `_get_impacted_aggregates_by_story`: IMPACTS_AGGREGATE ê´€ê³„ ì¡°íšŒ
- `_get_aggregate_snapshot`: Aggregate + HAS_FIELD ê´€ê³„ ì¡°íšŒ
- `_infer_bc_hint_from_aggregates`: BoundedContext â†’ HAS_AGGREGATE ê´€ê³„ ì¡°íšŒ
- `_infer_bc_hint_from_story`: Story â†’ IMPACTS_AGGREGATE â†’ Aggregate â†’ HAS_AGGREGATE â†’ BC ì¡°íšŒ
- `_get_aggregates_in_bc`: BC ë‚´ ëª¨ë“  Aggregate ì¡°íšŒ

---

## âœ… ê¸°ì¤€ 3: ìƒì„±ê¸° êµì²´ê°€ ì‰¬ì›€

**ì˜ë¯¸**: ê¸°ì¡´ ìƒì„±ê¸°, ìƒˆ ìƒì„±ê¸°, Mock ìƒì„±ê¸° ëª¨ë‘ ê°™ì€ ì…ë ¥ ê³„ì•½ìœ¼ë¡œ í˜¸ì¶œ ê°€ëŠ¥.

**ê²€ì¦ ë°©ë²•**:
- [ ] Adapter íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„ë¨ (`aggregate_draft_generator_adapter.py`)
- [ ] Context Builder ì¶œë ¥ì„ ê·¸ëŒ€ë¡œ ìƒì„±ê¸° ì…ë ¥ìœ¼ë¡œ ì „ë‹¬ ê°€ëŠ¥
- [ ] Mock ìƒì„±ê¸°ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥

**í˜„ì¬ ìƒíƒœ**: âœ… `aggregate_draft_generator_adapter.py`ê°€ Adapter íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„ë¨

**TODO**:
- [ ] ì‹¤ì œ ë ˆê±°ì‹œ ìƒì„±ê¸° ì—°ê²° (ì£¼ì„ ì²˜ë¦¬ëœ ë¶€ë¶„ í™œì„±í™”)
- [ ] Mock ìƒì„±ê¸°ë¡œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±

---

## ğŸ” ì¶”ê°€ ê²€ì¦ í•­ëª©

### Explain í•„ë“œ ê²€ì¦ (ë””ë²„ê¹…/ìš´ì˜ ì§€ì›)
- [ ] `explain` í•„ë“œê°€ í¬í•¨ë˜ì–´ ìˆìŒ
- [ ] `explain.dirty_groups`ë¡œ dirty ë¶„ë¥˜ í™•ì¸ ê°€ëŠ¥
- [ ] `explain.fallback_used`ë¡œ fallback ì‚¬ìš© ì—¬ë¶€ í™•ì¸ ê°€ëŠ¥
- [ ] `explain.bc_hint_source`ë¡œ BC íŒíŠ¸ ì¶œì²˜ í™•ì¸ ê°€ëŠ¥

**í˜„ì¬ ìƒíƒœ**: âœ… `include_explain=True` (ê¸°ë³¸ê°’)ë¡œ êµ¬í˜„ë¨

---

## ğŸ“Š í˜„ì¬ êµ¬í˜„ ìƒíƒœ ìš”ì•½

| ê¸°ì¤€ | ìƒíƒœ | ë¹„ê³  |
|------|------|------|
| ì…ë ¥ ê³„ì•½ ê³ ì • | âœ… êµ¬í˜„ë¨ | `build_phase_a_aggregate_context` ë°˜í™˜ êµ¬ì¡° í™•ì¸ í•„ìš” |
| Neo4j ì˜ì¡´ì„±ë§Œ | âœ… êµ¬í˜„ë¨ | Firebase/ì™¸ë¶€ JSON ì˜ì¡´ì„± ì—†ìŒ |
| ìƒì„±ê¸° êµì²´ ìš©ì´ | âœ… êµ¬í˜„ë¨ | Adapter íŒ¨í„´ ì ìš©, ë ˆê±°ì‹œ ì—°ê²° í•„ìš” |
| Explain í•„ë“œ | âœ… êµ¬í˜„ë¨ | ë””ë²„ê¹… ì •ë³´ í¬í•¨ |

---

## ğŸš¦ v1.2 ì§„ì… ê°€ëŠ¥ ì—¬ë¶€

**ê²°ë¡ **: âœ… **v1.2 ì§„ì… ê°€ëŠ¥**

**ì¡°ê±´ë¶€ í•­ëª©**:
1. ì‹¤ì œ Neo4j ì—°ê²° í…ŒìŠ¤íŠ¸ í•„ìš” (ì…ë ¥ ê³„ì•½ êµ¬ì¡° ìµœì¢… ê²€ì¦)
2. ë ˆê±°ì‹œ ìƒì„±ê¸° ì—°ê²° í•„ìš” (Adapter í™œì„±í™”)

---

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„ (v1.2 ì§„í–‰ ì „ ì¤€ë¹„ì‚¬í•­)

### Phase 0: Context Builder ì•ˆì •í™” (í˜„ì¬ ë‹¨ê³„)
1. [ ] Neo4j ì—°ê²° í…ŒìŠ¤íŠ¸ ë° ì…ë ¥ ê³„ì•½ êµ¬ì¡° ê²€ì¦
2. [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± (Mock Neo4j ë˜ëŠ” ì‹¤ì œ DB)
3. [ ] Edge case ì²˜ë¦¬ ê²€ì¦ (dirty ì—†ìŒ, BC ì—†ìŒ ë“±)

### Phase 1: Adapter ì—°ê²° (v1.2 ì¤€ë¹„)
4. [ ] ë ˆê±°ì‹œ ìƒì„±ê¸° import ê²½ë¡œ í™•ì¸
5. [ ] ì…ë ¥ ë³€í™˜ ë¡œì§ êµ¬í˜„ (Context â†’ Legacy Generator Input)
6. [ ] ì¶œë ¥ ë³€í™˜ ë¡œì§ êµ¬í˜„ (Legacy Generator Output â†’ SDD ê³„ì•½)
7. [ ] Mock ìƒì„±ê¸°ë¡œ í†µí•© í…ŒìŠ¤íŠ¸

### Phase 2: v1.2 í†µí•© (ë³¸ê²© ì§„í–‰)
8. [ ] Phase ë¶„ê¸° ë¡œì§ êµ¬í˜„
9. [ ] Firebase Payload ë³€ê²½ (ì°¸ì¡° í‚¤ ê¸°ë°˜)
10. [ ] Consumer ìˆ˜ì • (Neo4j ì¡°íšŒ + Context Builder í˜¸ì¶œ)
11. [ ] ê²°ê³¼ Neo4j ì—…ì„œíŠ¸ ë¡œì§ ì¶”ê°€
12. [ ] Run/Job ë©”íƒ€ ë…¸ë“œ ìƒì„±

